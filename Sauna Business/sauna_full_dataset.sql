SET XACT_ABORT ON;

BEGIN TRANSACTION;

CREATE TABLE Memberships (
    MembershipID INT PRIMARY KEY IDENTITY(1,1),
    MembershipName VARCHAR(50) NOT NULL,
    DiscountPercent DECIMAL(5,2) NOT NULL,
    MembershipPrice DECIMAL(10,2) NOT NULL
);

CREATE TABLE Customers (
    CustomerID INT PRIMARY KEY IDENTITY(1,1),
    FirstName VARCHAR(50),
    LastName VARCHAR(50),
    Email VARCHAR(100),
    MembershipID INT NULL,
    DateOfFirstVisit DATE,
    FOREIGN KEY (MembershipID) REFERENCES Memberships(MembershipID)
);

CREATE TABLE Sessions (
    SessionID INT PRIMARY KEY IDENTITY(1,1),
    SessionName VARCHAR(50),
    BasePrice DECIMAL(10,2)
);

CREATE TABLE Payments (
    PaymentID INT PRIMARY KEY IDENTITY(1,1),
    CustomerID INT NOT NULL,
    SessionID INT NULL,
    PurchasedMembershipID INT NULL,
    PaymentDate DATE NOT NULL,
    PaymentMethod VARCHAR(20) NOT NULL,
    AmountPaid DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (CustomerID) REFERENCES Customers(CustomerID),
    FOREIGN KEY (SessionID) REFERENCES Sessions(SessionID),
    FOREIGN KEY (PurchasedMembershipID) REFERENCES Memberships(MembershipID)
);

INSERT INTO Memberships (MembershipName, DiscountPercent, MembershipPrice) VALUES
('Regulars Club', 50.0, 30.0),
('NHS Membership', 20.0, 15.0),
('Concession Membership', 20.0, 12.0),
('Children Membership', 20.0, 10.0);

INSERT INTO Sessions (SessionName, BasePrice) VALUES
('Womens Only', 18.0),
('Mens Only', 18.0),
('Family Session', 15.0),
('Communal Session', 20.0);

INSERT INTO Customers (FirstName, LastName, Email, MembershipID, DateOfFirstVisit) VALUES
('Ian','Jenkins','ian.jenkins@example.com', 3, '2024-03-16'),
('Grace','Ward','grace.ward@example.com', 3, '2024-01-05'),
('Caroline','King','caroline.king@example.com', 1, '2024-02-25'),
('Isaac','Rivera','isaac.rivera@example.com', 3, '2024-04-12'),
('Ella','Hall','ella.hall@example.com', 1, '2024-02-06'),
('Leah','Carter','leah.carter@example.com', 3, '2024-03-11'),
('Allison','Coleman','allison.coleman@example.com', 1, '2024-01-17'),
('Eli','Coleman','eli.coleman@example.com', 1, '2024-04-05'),
('Henderson','Powell','henderson.powell@example.com', 1, '2024-04-21'),
('Brooklyn','Cox','brooklyn.cox@example.com', NULL, '2024-01-23'),
('William','Hughes','william.hughes@example.com', NULL, '2024-03-16'),
('Mia','Coleman','mia.coleman@example.com', 4, '2024-01-07'),
('Austin','Cook','austin.cook@example.com', NULL, '2024-02-22'),
('Nora','Howard','nora.howard@example.com', 1, '2024-01-24'),
('Ross','Turner','ross.turner@example.com', 4, '2024-02-28'),
('Amelia','Barnes','amelia.barnes@example.com', 1, '2024-03-11'),
('Nicholas','Ward','nicholas.ward@example.com', 2, '2024-01-05'),
('Jonathan','Bell','jonathan.bell@example.com', 1, '2024-04-13'),
('Bella','Henderson','bella.henderson@example.com', NULL, '2024-03-10'),
('Scarlett','Murphy','scarlett.murphy@example.com', NULL, '2024-04-24'),
('Samuel','Murphy','samuel.murphy@example.com', NULL, '2024-01-08'),
('Hannah','Henderson','hannah.henderson@example.com', 1, '2024-02-04'),
('Lucas','Scott','lucas.scott@example.com', NULL, '2024-03-13'),
('Christopher','Powell','christopher.powell@example.com', NULL, '2024-02-13'),
('Austin','Rivera','austin.rivera@example.com', NULL, '2024-01-25'),
('Andrew','Brooks','andrew.brooks@example.com', 1, '2024-04-16'),
('Ava','Coleman','ava.coleman@example.com', 3, '2024-02-08'),
('Eleanor','Turner','eleanor.turner@example.com', 1, '2024-01-18'),
('Connor','Hill','connor.hill@example.com', 1, '2024-02-05'),
('Sadie','Washington','sadie.washington@example.com', 1, '2024-01-28'),
('Noah','Hughes','noah.hughes@example.com', 3, '2024-03-06'),
('Bella','Reed','bella.reed@example.com', 2, '2024-03-25'),
('Ethan','Nelson','ethan.nelson@example.com', 3, '2024-03-12'),
('Liam','Rivera','liam.rivera@example.com', 2, '2024-04-03'),
('Aaliyah','Flores','aaliyah.flores@example.com', 3, '2024-01-09'),
('Adrian','Nelson','adrian.nelson@example.com', 4, '2024-01-09'),
('Hunter','Cox','hunter.cox@example.com', 4, '2024-04-08'),
('Harper','Ward','harper.ward@example.com', 4, '2024-03-05'),
('Charlotte','Flores','charlotte.flores@example.com', 2, '2024-04-24'),
('Daniel','Henderson','daniel.henderson@example.com', 4, '2024-02-24'),
('Ryan','Hill','ryan.hill@example.com', 4, '2024-04-29'),
('Wyatt','Turner','wyatt.turner@example.com', 1, '2024-04-27'),
('Genesis','Flores','genesis.flores@example.com', NULL, '2024-04-05'),
('Henry','Ward','henry.ward@example.com', 4, '2024-04-01'),
('Adrian','Brooks','adrian.brooks@example.com', 3, '2024-01-06'),
('Amelia','Henderson','amelia.henderson@example.com', 4, '2024-01-25'),
('Grayson','Green','grayson.green@example.com', 2, '2024-02-17'),
('Penelope','Long','penelope.long@example.com', 4, '2024-03-16'),
('Joseph','Patterson','joseph.patterson@example.com', 2, '2024-03-30'),
('Mia','Reed','mia.reed@example.com', 1, '2024-03-12'),
('Joseph','Richardson','joseph.richardson@example.com', 3, '2024-02-03'),
('Hannah','Howard','hannah.howard@example.com', 4, '2024-03-08'),
('Adam','Powell','adam.powell@example.com', NULL, '2024-04-26'),
('Noah','Long','noah.long@example.com', 1, '2024-02-17'),
('Harper','Rivera','harper.rivera@example.com', 4, '2024-03-31'),
('Charlotte','Bennett','charlotte.bennett@example.com', 2, '2024-03-14'),
('Julian','Barnes','julian.barnes@example.com', 2, '2024-01-08'),
('Ross','Ward','ross.ward@example.com', 4, '2024-02-19'),
('Grayson','Barnes','grayson.barnes@example.com', NULL, '2024-03-08'),
('Addison','Murphy','addison.murphy@example.com', 4, '2024-01-24'),
('Savannah','Reed','savannah.reed@example.com', 4, '2024-04-18'),
('Aaliyah','Price','aaliyah.price@example.com', 3, '2024-02-29'),
('Cameron','Ross','cameron.ross@example.com', 2, '2024-02-03'),
('Thomas','Bell','thomas.bell@example.com', NULL, '2024-04-28'),
('Sadie','Bell','sadie.bell@example.com', 2, '2024-01-27'),
('Adrian','Perry','adrian.perry@example.com', 1, '2024-01-02'),
('Ross','Adams','ross.adams@example.com', 2, '2024-04-04'),
('Samuel','Bailey','samuel.bailey@example.com', 2, '2024-02-08'),
('Sadie','Jenkins','sadie.jenkins@example.com', 1, '2024-03-21'),
('Sadie','Rivera','sadie.rivera@example.com', 1, '2024-02-21'),
('Lucy','Perry','lucy.perry@example.com', 2, '2024-04-03'),
('Connor','Jordan','connor.jordan@example.com', 4, '2024-01-18'),
('Grayson','Wright','grayson.wright@example.com', 1, '2024-04-05'),
('Lily','Long','lily.long@example.com', 1, '2024-01-22'),
('Lily','Turner','lily.turner@example.com', 2, '2024-03-26'),
('William','Wright','william.wright@example.com', 2, '2024-04-24'),
('Nora','Brooks','nora.brooks@example.com', 1, '2024-02-08'),
('Olivia','Patterson','olivia.patterson@example.com', 4, '2024-02-20'),
('Lucas','Ward','lucas.ward@example.com', 2, '2024-04-11'),
('Dylan','Hall','dylan.hall@example.com', 1, '2024-03-15'),
('Liam','Ross','liam.ross@example.com', NULL, '2024-03-15'),
('Alexander','Hughes','alexander.hughes@example.com', 4, '2024-03-16'),
('Charlotte','Jordan','charlotte.jordan@example.com', 2, '2024-04-24'),
('Jack','Patterson','jack.patterson@example.com', 3, '2024-02-15'),
('Joseph','Bennett','joseph.bennett@example.com', 4, '2024-04-02'),
('Addison','Henderson','addison.henderson@example.com', NULL, '2024-04-03'),
('Zoe','Green','zoe.green@example.com', 2, '2024-01-01'),
('Connor','Carter','connor.carter@example.com', 4, '2024-03-24'),
('Alexander','Nelson','alexander.nelson@example.com', 4, '2024-01-08'),
('Samuel','Price','samuel.price@example.com', 2, '2024-03-01'),
('Sophia','Cook','sophia.cook@example.com', 2, '2024-03-24'),
('Anna','Barnes','anna.barnes@example.com', 2, '2024-04-06'),
('Henry','Bennett','henry.bennett@example.com', 4, '2024-03-18'),
('Harper','Howard','harper.howard@example.com', 1, '2024-02-20'),
('Matthew','Patterson','matthew.patterson@example.com', NULL, '2024-02-10'),
('Samuel','Green','samuel.green@example.com', 1, '2024-03-28'),
('Ava','Price','ava.price@example.com', 4, '2024-04-13'),
('Austin','Wood','austin.wood@example.com', 4, '2024-02-29'),
('Lucas','Bell','lucas.bell@example.com', 4, '2024-01-29'),
('Ethan','Coleman','ethan.coleman@example.com', 4, '2024-01-23');

INSERT INTO Payments (CustomerID, SessionID, PurchasedMembershipID, PaymentDate, PaymentMethod, AmountPaid) VALUES
(1, NULL, 3, '2024-01-08', 'MembershipPurchase', 12.0),
(1, 2, NULL, '2024-02-25', 'MembershipDiscount', 14.4),
(2, 2, NULL, '2024-01-26', 'MembershipDiscount', 14.4),
(3, NULL, 1, '2024-05-12', 'MembershipPurchase', 30.0),
(3, 3, NULL, '2024-03-16', 'MembershipDiscount', 7.5),
(4, NULL, 3, '2024-03-03', 'MembershipPurchase', 12.0),
(4, 2, NULL, '2024-04-24', 'MembershipDiscount', 14.4),
(5, NULL, 1, '2024-05-09', 'MembershipPurchase', 30.0),
(5, 1, NULL, '2024-03-27', 'MembershipDiscount', 9.0),
(6, NULL, 3, '2024-03-29', 'MembershipPurchase', 12.0),
(6, 4, NULL, '2024-02-23', 'MembershipDiscount', 16.0),
(7, NULL, 1, '2024-02-21', 'MembershipPurchase', 30.0),
(7, 4, NULL, '2024-02-29', 'MembershipDiscount', 10.0),
(8, NULL, 1, '2024-02-03', 'MembershipPurchase', 30.0),
(8, 1, NULL, '2024-01-06', 'MembershipDiscount', 9.0),
(9, NULL, 1, '2024-04-18', 'MembershipPurchase', 30.0),
(9, 3, NULL, '2024-01-02', 'MembershipDiscount', 7.5),
(10, 3, NULL, '2024-01-28', 'FullPrice', 15.0),
(11, 2, NULL, '2024-04-28', 'FullPrice', 18.0),
(12, NULL, 4, '2024-05-28', 'MembershipPurchase', 10.0),
(12, 4, NULL, '2024-03-08', 'MembershipDiscount', 16.0),
(13, 2, NULL, '2024-04-19', 'FullPrice', 18.0),
(14, NULL, 1, '2024-04-13', 'MembershipPurchase', 30.0),
(14, 1, NULL, '2024-04-02', 'MembershipDiscount', 9.0),
(15, 4, NULL, '2024-03-06', 'MembershipDiscount', 16.0),
(16, NULL, 1, '2024-05-22', 'MembershipPurchase', 30.0),
(16, 3, NULL, '2024-01-29', 'MembershipDiscount', 7.5),
(17, 1, NULL, '2024-03-27', 'MembershipDiscount', 14.4),
(18, NULL, 1, '2024-05-27', 'MembershipPurchase', 30.0),
(18, 2, NULL, '2024-01-05', 'MembershipDiscount', 9.0),
(19, 3, NULL, '2024-05-16', 'FullPrice', 15.0),
(20, 1, NULL, '2024-02-29', 'FullPrice', 18.0),
(21, 4, NULL, '2024-02-23', 'FullPrice', 20.0),
(22, NULL, 1, '2024-05-28', 'MembershipPurchase', 30.0),
(22, 4, NULL, '2024-03-12', 'MembershipDiscount', 10.0),
(23, 1, NULL, '2024-04-14', 'FullPrice', 18.0),
(24, 2, NULL, '2024-05-02', 'FullPrice', 18.0),
(25, 4, NULL, '2024-03-08', 'FullPrice', 20.0),
(26, 1, NULL, '2024-01-28', 'MembershipDiscount', 9.0),
(27, NULL, 3, '2024-01-19', 'MembershipPurchase', 12.0),
(27, 2, NULL, '2024-01-27', 'MembershipDiscount', 14.4),
(28, 3, NULL, '2024-05-28', 'MembershipDiscount', 7.5),
(29, NULL, 1, '2024-04-26', 'MembershipPurchase', 30.0),
(29, 1, NULL, '2024-04-04', 'MembershipDiscount', 9.0),
(30, NULL, 1, '2024-02-21', 'MembershipPurchase', 30.0),
(30, 4, NULL, '2024-03-31', 'MembershipDiscount', 10.0),
(31, NULL, 3, '2024-04-10', 'MembershipPurchase', 12.0),
(31, 1, NULL, '2024-03-18', 'MembershipDiscount', 14.4),
(32, NULL, 2, '2024-04-12', 'MembershipPurchase', 15.0),
(32, 3, NULL, '2024-01-29', 'MembershipDiscount', 12.0),
(33, NULL, 3, '2024-05-30', 'MembershipPurchase', 12.0),
(33, 1, NULL, '2024-04-12', 'MembershipDiscount', 14.4),
(34, 3, NULL, '2024-02-10', 'MembershipDiscount', 12.0),
(35, NULL, 3, '2024-01-28', 'MembershipPurchase', 12.0),
(35, 1, NULL, '2024-02-28', 'MembershipDiscount', 14.4),
(36, NULL, 4, '2024-02-18', 'MembershipPurchase', 10.0),
(36, 2, NULL, '2024-02-14', 'MembershipDiscount', 14.4),
(37, 1, NULL, '2024-01-05', 'MembershipDiscount', 14.4),
(38, NULL, 4, '2024-04-28', 'MembershipPurchase', 10.0),
(38, 2, NULL, '2024-04-08', 'MembershipDiscount', 14.4),
(39, NULL, 2, '2024-03-03', 'MembershipPurchase', 15.0),
(39, 4, NULL, '2024-02-14', 'MembershipDiscount', 16.0),
(40, 2, NULL, '2024-01-22', 'MembershipDiscount', 14.4),
(41, NULL, 4, '2024-01-12', 'MembershipPurchase', 10.0),
(41, 1, NULL, '2024-01-27', 'MembershipDiscount', 14.4),
(42, NULL, 1, '2024-04-11', 'MembershipPurchase', 30.0),
(42, 2, NULL, '2024-02-07', 'MembershipDiscount', 9.0),
(43, 4, NULL, '2024-02-03', 'FullPrice', 20.0),
(44, NULL, 4, '2024-05-29', 'MembershipPurchase', 10.0),
(44, 4, NULL, '2024-04-29', 'MembershipDiscount', 16.0),
(45, NULL, 3, '2024-04-02', 'MembershipPurchase', 12.0),
(45, 3, NULL, '2024-05-18', 'MembershipDiscount', 12.0),
(46, NULL, 4, '2024-05-23', 'MembershipPurchase', 10.0),
(46, 2, NULL, '2024-01-16', 'MembershipDiscount', 14.4),
(47, 2, NULL, '2024-05-17', 'MembershipDiscount', 14.4),
(48, 3, NULL, '2024-01-04', 'MembershipDiscount', 12.0),
(49, NULL, 2, '2024-03-11', 'MembershipPurchase', 15.0),
(49, 2, NULL, '2024-01-06', 'MembershipDiscount', 14.4),
(50, 2, NULL, '2024-05-12', 'MembershipDiscount', 9.0),
(51, NULL, 3, '2024-04-08', 'MembershipPurchase', 12.0),
(51, 1, NULL, '2024-05-21', 'MembershipDiscount', 14.4),
(52, NULL, 4, '2024-01-29', 'MembershipPurchase', 10.0),
(52, 3, NULL, '2024-05-19', 'MembershipDiscount', 12.0),
(53, 2, NULL, '2024-04-13', 'FullPrice', 18.0),
(54, NULL, 1, '2024-03-15', 'MembershipPurchase', 30.0),
(54, 1, NULL, '2024-03-15', 'MembershipDiscount', 9.0),
(55, NULL, 4, '2024-02-14', 'MembershipPurchase', 10.0),
(55, 4, NULL, '2024-01-07', 'MembershipDiscount', 16.0),
(56, NULL, 2, '2024-05-24', 'MembershipPurchase', 15.0),
(56, 1, NULL, '2024-05-04', 'MembershipDiscount', 14.4),
(57, NULL, 2, '2024-02-03', 'MembershipPurchase', 15.0),
(57, 1, NULL, '2024-01-18', 'MembershipDiscount', 14.4),
(58, NULL, 4, '2024-01-12', 'MembershipPurchase', 10.0),
(58, 1, NULL, '2024-01-18', 'MembershipDiscount', 14.4),
(59, 4, NULL, '2024-03-11', 'FullPrice', 20.0),
(60, NULL, 4, '2024-05-01', 'MembershipPurchase', 10.0),
(60, 2, NULL, '2024-03-13', 'MembershipDiscount', 14.4),
(61, NULL, 4, '2024-03-15', 'MembershipPurchase', 10.0),
(61, 1, NULL, '2024-05-24', 'MembershipDiscount', 14.4),
(62, NULL, 3, '2024-04-04', 'MembershipPurchase', 12.0),
(62, 1, NULL, '2024-01-18', 'MembershipDiscount', 14.4),
(63, NULL, 2, '2024-03-02', 'MembershipPurchase', 15.0),
(63, 4, NULL, '2024-04-19', 'MembershipDiscount', 16.0),
(64, 2, NULL, '2024-05-15', 'FullPrice', 18.0),
(65, NULL, 2, '2024-04-08', 'MembershipPurchase', 15.0),
(65, 4, NULL, '2024-01-22', 'MembershipDiscount', 16.0),
(66, NULL, 1, '2024-03-06', 'MembershipPurchase', 30.0),
(66, 4, NULL, '2024-01-07', 'MembershipDiscount', 10.0),
(67, NULL, 2, '2024-04-07', 'MembershipPurchase', 15.0),
(67, 2, NULL, '2024-03-08', 'MembershipDiscount', 14.4),
(68, 1, NULL, '2024-03-05', 'MembershipDiscount', 14.4),
(69, NULL, 1, '2024-01-20', 'MembershipPurchase', 30.0),
(69, 1, NULL, '2024-03-07', 'MembershipDiscount', 9.0),
(70, NULL, 1, '2024-02-28', 'MembershipPurchase', 30.0),
(70, 1, NULL, '2024-03-14', 'MembershipDiscount', 9.0),
(71, NULL, 2, '2024-05-14', 'MembershipPurchase', 15.0),
(71, 4, NULL, '2024-03-23', 'MembershipDiscount', 16.0),
(72, 1, NULL, '2024-05-04', 'MembershipDiscount', 14.4),
(73, NULL, 1, '2024-04-08', 'MembershipPurchase', 30.0),
(73, 2, NULL, '2024-04-30', 'MembershipDiscount', 9.0),
(74, NULL, 1, '2024-03-21', 'MembershipPurchase', 30.0),
(74, 3, NULL, '2024-01-27', 'MembershipDiscount', 7.5),
(75, NULL, 2, '2024-02-15', 'MembershipPurchase', 15.0),
(75, 4, NULL, '2024-03-08', 'MembershipDiscount', 16.0),
(76, NULL, 2, '2024-05-05', 'MembershipPurchase', 15.0),
(76, 1, NULL, '2024-01-04', 'MembershipDiscount', 14.4),
(77, NULL, 1, '2024-01-24', 'MembershipPurchase', 30.0),
(77, 4, NULL, '2024-05-19', 'MembershipDiscount', 10.0),
(78, NULL, 4, '2024-02-21', 'MembershipPurchase', 10.0),
(78, 1, NULL, '2024-03-24', 'MembershipDiscount', 14.4),
(79, NULL, 2, '2024-02-01', 'MembershipPurchase', 15.0),
(79, 3, NULL, '2024-02-17', 'MembershipDiscount', 12.0),
(80, NULL, 1, '2024-03-25', 'MembershipPurchase', 30.0),
(80, 4, NULL, '2024-05-19', 'MembershipDiscount', 10.0),
(81, 1, NULL, '2024-03-13', 'FullPrice', 18.0),
(82, NULL, 4, '2024-05-25', 'MembershipPurchase', 10.0),
(82, 1, NULL, '2024-04-09', 'MembershipDiscount', 14.4),
(83, NULL, 2, '2024-05-15', 'MembershipPurchase', 15.0),
(83, 4, NULL, '2024-03-11', 'MembershipDiscount', 16.0),
(84, NULL, 3, '2024-01-22', 'MembershipPurchase', 12.0),
(84, 2, NULL, '2024-02-06', 'MembershipDiscount', 14.4),
(85, 4, NULL, '2024-04-06', 'MembershipDiscount', 16.0),
(86, 1, NULL, '2024-04-04', 'FullPrice', 18.0),
(87, 2, NULL, '2024-02-16', 'MembershipDiscount', 14.4),
(88, NULL, 4, '2024-03-08', 'MembershipPurchase', 10.0),
(88, 1, NULL, '2024-02-15', 'MembershipDiscount', 14.4),
(89, NULL, 4, '2024-01-07', 'MembershipPurchase', 10.0),
(89, 1, NULL, '2024-02-23', 'MembershipDiscount', 14.4),
(90, NULL, 2, '2024-02-14', 'MembershipPurchase', 15.0),
(90, 4, NULL, '2024-01-26', 'MembershipDiscount', 16.0),
(91, NULL, 2, '2024-05-26', 'MembershipPurchase', 15.0),
(91, 2, NULL, '2024-01-21', 'MembershipDiscount', 14.4),
(92, NULL, 2, '2024-04-20', 'MembershipPurchase', 15.0),
(92, 2, NULL, '2024-02-09', 'MembershipDiscount', 14.4),
(93, NULL, 4, '2024-01-03', 'MembershipPurchase', 10.0),
(93, 2, NULL, '2024-04-19', 'MembershipDiscount', 14.4),
(94, NULL, 1, '2024-02-04', 'MembershipPurchase', 30.0),
(94, 1, NULL, '2024-01-31', 'MembershipDiscount', 9.0),
(95, 2, NULL, '2024-03-12', 'FullPrice', 18.0),
(96, NULL, 1, '2024-05-25', 'MembershipPurchase', 30.0),
(96, 2, NULL, '2024-02-14', 'MembershipDiscount', 9.0),
(97, NULL, 4, '2024-05-17', 'MembershipPurchase', 10.0),
(97, 4, NULL, '2024-01-13', 'MembershipDiscount', 16.0),
(98, 3, NULL, '2024-04-13', 'MembershipDiscount', 12.0),
(99, NULL, 4, '2024-01-26', 'MembershipPurchase', 10.0),
(99, 4, NULL, '2024-03-13', 'MembershipDiscount', 16.0),
(100, 1, NULL, '2024-01-19', 'MembershipDiscount', 14.4);

COMMIT;